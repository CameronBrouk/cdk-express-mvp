"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createLogDriver = void 0;
const aws_cdk_lib_1 = require("aws-cdk-lib");
const aws_ecs_1 = require("aws-cdk-lib/aws-ecs");
const aws_logs_1 = require("aws-cdk-lib/aws-logs");
const createLogDriver = (scope, props) => {
    return aws_ecs_1.AwsLogDriver.awsLogs({
        logGroup: new aws_logs_1.LogGroup(scope, props.cdkIdentifier, {
            retention: aws_logs_1.RetentionDays.FIVE_DAYS,
            removalPolicy: aws_cdk_lib_1.RemovalPolicy.DESTROY,
            logGroupName: props.logGroupName,
        }),
        streamPrefix: props.prefix,
        multilinePattern: '^(INFO|DEBUG|WARN|ERROR|CRITICAL|SELECT|PRISMA)', // https://stackoverflow.com/questions/67396522/cloudwatch-multiline-log-messages-from-containerized-app-runnning-on-ecs-ec2
        // mode: AwsLogDriverMode.BLOCKING, // Logs are prioritized over the application -> https://dalefro.medium.com/non-blocking-docker-logging-ebd3e1a1e89d
    });
};
exports.createLogDriver = createLogDriver;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLWRyaXZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxvZy1kcml2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsNkNBQTJDO0FBQzNDLGlEQUFrRDtBQUNsRCxtREFBOEQ7QUFRdkQsTUFBTSxlQUFlLEdBQUcsQ0FBQyxLQUFnQixFQUFFLEtBQVksRUFBRSxFQUFFO0lBQ2hFLE9BQU8sc0JBQVksQ0FBQyxPQUFPLENBQUM7UUFDMUIsUUFBUSxFQUFFLElBQUksbUJBQVEsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLGFBQWEsRUFBRTtZQUNqRCxTQUFTLEVBQUUsd0JBQWEsQ0FBQyxTQUFTO1lBQ2xDLGFBQWEsRUFBRSwyQkFBYSxDQUFDLE9BQU87WUFDcEMsWUFBWSxFQUFFLEtBQUssQ0FBQyxZQUFZO1NBQ2pDLENBQUM7UUFDRixZQUFZLEVBQUUsS0FBSyxDQUFDLE1BQU07UUFDMUIsZ0JBQWdCLEVBQUUsaURBQWlELEVBQUUsNEhBQTRIO1FBQ2pNLHVKQUF1SjtLQUN4SixDQUFDLENBQUE7QUFDSixDQUFDLENBQUE7QUFYWSxRQUFBLGVBQWUsbUJBVzNCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVtb3ZhbFBvbGljeSB9IGZyb20gJ2F3cy1jZGstbGliJ1xuaW1wb3J0IHsgQXdzTG9nRHJpdmVyIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWVjcydcbmltcG9ydCB7IExvZ0dyb3VwLCBSZXRlbnRpb25EYXlzIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWxvZ3MnXG5pbXBvcnQgeyBDb25zdHJ1Y3QgfSBmcm9tICdjb25zdHJ1Y3RzJ1xuXG50eXBlIFByb3BzID0ge1xuICBjZGtJZGVudGlmaWVyOiBzdHJpbmdcbiAgbG9nR3JvdXBOYW1lOiBzdHJpbmdcbiAgcHJlZml4OiBzdHJpbmdcbn1cbmV4cG9ydCBjb25zdCBjcmVhdGVMb2dEcml2ZXIgPSAoc2NvcGU6IENvbnN0cnVjdCwgcHJvcHM6IFByb3BzKSA9PiB7XG4gIHJldHVybiBBd3NMb2dEcml2ZXIuYXdzTG9ncyh7XG4gICAgbG9nR3JvdXA6IG5ldyBMb2dHcm91cChzY29wZSwgcHJvcHMuY2RrSWRlbnRpZmllciwge1xuICAgICAgcmV0ZW50aW9uOiBSZXRlbnRpb25EYXlzLkZJVkVfREFZUyxcbiAgICAgIHJlbW92YWxQb2xpY3k6IFJlbW92YWxQb2xpY3kuREVTVFJPWSxcbiAgICAgIGxvZ0dyb3VwTmFtZTogcHJvcHMubG9nR3JvdXBOYW1lLFxuICAgIH0pLFxuICAgIHN0cmVhbVByZWZpeDogcHJvcHMucHJlZml4LFxuICAgIG11bHRpbGluZVBhdHRlcm46ICdeKElORk98REVCVUd8V0FSTnxFUlJPUnxDUklUSUNBTHxTRUxFQ1R8UFJJU01BKScsIC8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY3Mzk2NTIyL2Nsb3Vkd2F0Y2gtbXVsdGlsaW5lLWxvZy1tZXNzYWdlcy1mcm9tLWNvbnRhaW5lcml6ZWQtYXBwLXJ1bm5uaW5nLW9uLWVjcy1lYzJcbiAgICAvLyBtb2RlOiBBd3NMb2dEcml2ZXJNb2RlLkJMT0NLSU5HLCAvLyBMb2dzIGFyZSBwcmlvcml0aXplZCBvdmVyIHRoZSBhcHBsaWNhdGlvbiAtPiBodHRwczovL2RhbGVmcm8ubWVkaXVtLmNvbS9ub24tYmxvY2tpbmctZG9ja2VyLWxvZ2dpbmctZWJkM2UxYTFlODlkXG4gIH0pXG59XG4iXX0=